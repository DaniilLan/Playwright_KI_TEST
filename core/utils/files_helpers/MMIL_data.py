class MMIL:
    transcript = {
        1: ("j4Hb", "Да"),
        2: ("j4Hb", "Нет"),
    }
    answer_test_yes = [[1, 1], [1, 1], [1, 2], [1, 3], [1, 4], [2, 5], [2, 6], [2, 7], [2, 8], [1, 9], [1, 10], [1, 11],
                       [1, 12], [1, 13], [1, 14], [1, 15], [1, 16], [1, 17], [1, 18], [1, 19], [1, 20], [1, 21],
                       [1, 22],
                       [1, 23], [1, 24], [1, 25], [1, 26], [1, 27], [1, 28], [1, 29], [1, 30], [1, 31], [1, 32],
                       [1, 33],
                       [1, 34], [1, 35], [2, 36], [1, 37], [1, 38], [1, 39], [1, 40], [1, 41], [1, 42], [1, 43],
                       [1, 44],
                       [1, 45], [1, 46], [1, 47], [1, 48], [1, 49], [2, 50], [1, 51], [1, 52], [1, 53], [1, 54],
                       [1, 55],
                       [1, 56], [1, 57], [2, 58], [2, 59], [1, 60], [1, 61], [1, 62], [1, 63], [1, 64], [1, 65],
                       [1, 66],
                       [1, 67], [1, 68], [1, 69], [1, 70], [1, 71], [1, 72], [1, 73], [1, 74], [1, 75], [1, 76],
                       [1, 77],
                       [1, 78], [1, 79], [1, 80], [1, 81], [1, 82], [1, 83], [1, 84], [1, 85], [1, 86], [1, 87],
                       [1, 88],
                       [1, 89], [1, 90], [1, 91], [1, 92], [1, 93], [1, 94], [1, 95], [1, 96], [1, 97], [1, 98],
                       [1, 99],
                       [1, 100], [1, 101], [1, 102], [1, 103], [1, 104], [1, 105], [1, 106], [1, 107], [1, 108],
                       [1, 109],
                       [1, 110], [1, 111], [1, 112], [1, 113], [1, 114], [1, 115], [1, 116], [1, 117], [1, 118],
                       [1, 119],
                       [1, 120], [1, 121], [1, 122], [1, 123], [1, 124], [1, 125], [1, 126], [1, 127], [1, 128],
                       [1, 129],
                       [1, 130], [1, 131], [1, 132], [1, 133], [1, 134], [1, 135], [1, 136], [1, 137], [1, 138],
                       [1, 139],
                       [1, 140], [1, 141], [1, 142], [1, 143], [1, 144], [1, 145], [1, 146], [1, 147], [1, 148],
                       [1, 149],
                       [1, 150], [1, 151], [1, 152], [1, 153], [1, 154], [1, 155], [1, 156], [1, 157], [1, 158],
                       [1, 159],
                       [1, 160], [1, 161], [1, 162], [1, 163], [1, 164], [1, 165], [1, 166], [1, 167], [1, 168],
                       [1, 169],
                       [1, 170], [1, 171], [1, 172], [1, 173], [1, 174], [1, 175], [1, 176], [1, 177], [1, 178],
                       [1, 179],
                       [1, 180], [1, 181], [1, 182], [1, 183], [1, 184], [1, 185], [1, 186], [1, 187], [1, 188],
                       [1, 189],
                       [1, 190], [1, 191], [1, 192], [1, 193], [1, 194], [1, 195], [1, 196], [1, 197], [1, 198],
                       [1, 199],
                       [1, 200], [1, 201], [1, 202], [1, 203], [1, 204], [1, 205], [1, 206], [1, 207], [1, 208],
                       [1, 209],
                       [1, 210], [1, 211], [1, 212], [1, 213], [1, 214], [1, 215], [1, 216], [1, 217], [1, 218],
                       [1, 219],
                       [1, 220], [1, 221], [1, 222], [1, 223], [1, 224], [1, 225], [1, 226], [1, 227], [1, 228],
                       [1, 229],
                       [1, 230], [1, 231], [1, 232], [1, 233], [1, 234], [1, 235], [1, 236], [1, 237], [1, 238],
                       [1, 239],
                       [1, 240], [1, 241], [1, 242], [1, 243], [1, 244], [1, 245], [1, 246], [1, 247], [1, 248],
                       [1, 249],
                       [1, 250], [1, 251], [1, 252], [1, 253], [1, 254], [1, 255], [1, 256], [1, 257], [1, 258],
                       [1, 259],
                       [1, 260], [1, 261], [1, 262], [1, 263], [1, 264], [1, 265], [1, 266], [1, 267], [1, 268],
                       [1, 269],
                       [1, 270], [1, 271], [1, 272], [1, 273], [1, 274], [1, 275], [1, 276], [1, 277], [1, 278],
                       [1, 279],
                       [1, 280], [1, 281], [1, 282], [1, 283], [1, 284], [1, 285], [1, 286], [1, 287], [1, 288],
                       [1, 289],
                       [1, 290], [1, 291], [1, 292], [1, 293], [1, 294], [1, 295], [1, 296], [1, 297], [1, 298],
                       [1, 299],
                       [1, 300], [1, 301], [1, 302], [1, 303], [1, 304], [1, 305], [2, 306], [2, 307], [2, 308],
                       [1, 309],
                       [1, 310], [1, 311], [1, 312], [1, 313], [1, 314], [1, 315], [1, 316], [1, 317], [1, 318],
                       [1, 319],
                       [1, 320], [1, 321], [1, 322], [1, 323], [1, 324], [1, 325], [1, 326], [1, 327], [1, 328],
                       [1, 329],
                       [1, 330], [1, 331], [1, 332], [1, 333], [1, 334], [1, 335], [2, 336], [2, 337], [1, 338],
                       [1, 339],
                       [1, 340], [1, 341], [1, 342], [1, 343], [1, 344], [1, 345], [1, 346], [1, 347], [1, 348],
                       [1, 349],
                       [1, 350], [1, 351], [1, 352], [1, 353], [1, 354], [1, 355], [1, 356], [1, 357], [1, 358],
                       [1, 359],
                       [1, 360], [1, 361], [1, 362], [1, 363], [1, 364], [1, 365], [1, 366], [1, 367], [1, 368],
                       [1, 369],
                       [1, 370], [1, 371], [1, 372], [1, 373], [1, 374], [1, 375], [1, 376]]

    answer_test_no = [[2, 1], [2, 1], [2, 2], [2, 3], [2, 4], [2, 5], [2, 6], [2, 7], [2, 8], [2, 9], [2, 10],
                      [2, 11], [2, 12], [2, 13], [2, 14], [2, 15], [2, 16], [2, 17], [2, 18], [2, 19], [2, 20],
                      [2, 21], [2, 22], [2, 23], [2, 24], [2, 25], [2, 26], [2, 27], [2, 28], [2, 29], [2, 30],
                      [2, 31], [2, 32], [2, 33], [2, 34], [2, 35], [2, 36], [2, 37], [2, 38], [2, 39], [2, 40],
                      [2, 41], [2, 42], [2, 43], [2, 44], [2, 45], [2, 46], [2, 47], [2, 48], [2, 49], [2, 50],
                      [2, 51], [2, 52], [2, 53], [2, 54], [2, 55], [2, 56], [2, 57], [2, 58], [2, 59], [2, 60],
                      [2, 61], [2, 62], [2, 63], [2, 64], [2, 65], [2, 66], [2, 67], [2, 68], [2, 69], [2, 70],
                      [2, 71], [2, 72], [2, 73], [2, 74], [2, 75], [2, 76], [2, 77], [2, 78], [2, 79], [2, 80],
                      [2, 81], [2, 82], [2, 83], [2, 84], [2, 85], [2, 86], [2, 87], [2, 88], [2, 89], [2, 90],
                      [2, 91], [2, 92], [2, 93], [2, 94], [2, 95], [2, 96], [2, 97], [2, 98], [2, 99], [2, 100],
                      [2, 101], [2, 102], [2, 103], [2, 104], [2, 105], [2, 106], [2, 107], [2, 108], [2, 109],
                      [2, 110], [2, 111], [2, 112], [2, 113], [2, 114], [2, 115], [2, 116], [2, 117], [2, 118],
                      [2, 119], [2, 120], [2, 121], [2, 122], [2, 123], [2, 124], [2, 125], [2, 126], [2, 127],
                      [2, 128], [2, 129], [2, 130], [2, 131], [2, 132], [2, 133], [2, 134], [2, 135], [2, 136],
                      [2, 137], [2, 138], [2, 139], [2, 140], [2, 141], [2, 142], [2, 143], [2, 144], [2, 145],
                      [2, 146], [2, 147], [2, 148], [2, 149], [2, 150], [2, 151], [2, 152], [2, 153], [2, 154],
                      [2, 155], [2, 156], [2, 157], [2, 158], [2, 159], [2, 160], [2, 161], [2, 162], [2, 163],
                      [2, 164], [2, 165], [2, 166], [2, 167], [2, 168], [2, 169], [2, 170], [2, 171], [2, 172],
                      [2, 173], [2, 174], [2, 175], [2, 176], [2, 177], [2, 178], [2, 179], [2, 180], [2, 181],
                      [2, 182], [2, 183], [2, 184], [2, 185], [2, 186], [2, 187], [2, 188], [2, 189], [2, 190],
                      [2, 191], [2, 192], [2, 193], [2, 194], [2, 195], [2, 196], [2, 197], [2, 198], [2, 199],
                      [2, 200], [2, 201], [2, 202], [2, 203], [2, 204], [2, 205], [2, 206], [2, 207], [2, 208],
                      [2, 209], [2, 210], [2, 211], [2, 212], [2, 213], [2, 214], [2, 215], [2, 216], [2, 217],
                      [2, 218], [2, 219], [2, 220], [2, 221], [2, 222], [2, 223], [2, 224], [2, 225], [2, 226],
                      [2, 227], [2, 228], [2, 229], [2, 230], [2, 231], [2, 232], [2, 233], [2, 234], [2, 235],
                      [2, 236], [2, 237], [2, 238], [2, 239], [2, 240], [2, 241], [2, 242], [2, 243], [2, 244],
                      [2, 245], [2, 246], [2, 247], [2, 248], [2, 249], [2, 250], [2, 251], [2, 252], [2, 253],
                      [2, 254], [2, 255], [2, 256], [2, 257], [2, 258], [2, 259], [2, 260], [2, 261], [2, 262],
                      [2, 263], [2, 264], [2, 265], [2, 266], [2, 267], [2, 268], [2, 269], [2, 270], [2, 271],
                      [2, 272], [2, 273], [2, 274], [2, 275], [2, 276], [2, 277], [2, 278], [2, 279], [2, 280],
                      [2, 281], [2, 282], [2, 283], [2, 284], [2, 285], [2, 286], [2, 287], [2, 288], [2, 289],
                      [2, 290], [2, 291], [2, 292], [2, 293], [2, 294], [2, 295], [2, 296], [2, 297], [2, 298],
                      [2, 299], [2, 300], [2, 301], [2, 302], [2, 303], [2, 304], [2, 305], [2, 306], [2, 307],
                      [2, 308], [2, 309], [2, 310], [2, 311], [2, 312], [2, 313], [2, 314], [2, 315], [2, 316],
                      [2, 317], [2, 318], [2, 319], [2, 320], [2, 321], [2, 322], [2, 323], [2, 324], [2, 325],
                      [2, 326], [2, 327], [2, 328], [2, 329], [2, 330], [2, 331], [2, 332], [2, 333], [2, 334],
                      [2, 335], [2, 336], [2, 337], [2, 338], [2, 339], [2, 340], [2, 341], [2, 342], [2, 343],
                      [2, 344], [2, 345], [2, 346], [2, 347], [2, 348], [2, 349], [2, 350], [2, 351], [2, 352],
                      [2, 353], [2, 354], [2, 355], [2, 356], [2, 357], [2, 358], [2, 359], [2, 360], [2, 361],
                      [2, 362], [2, 363], [2, 364], [2, 365], [2, 366], [2, 367], [2, 368], [2, 369], [2, 370],
                      [2, 371], [2, 372], [2, 373], [2, 374], [2, 375], [2, 376]]

    answer_BAA1_random = [[1, 1], [2, 1], [1, 2], [2, 3], [1, 4], [1, 5], [1, 6], [1, 7], [1, 8], [1, 9], [1, 10],
                          [2, 11],
                          [1, 12], [2, 13], [2, 14], [1, 15], [2, 16], [2, 17], [2, 18], [1, 19], [2, 20], [1, 21],
                          [1, 22],
                          [2, 23], [1, 24], [1, 25], [2, 26], [2, 27], [1, 28], [2, 29], [2, 30], [1, 31], [1, 32],
                          [1, 33],
                          [2, 34], [2, 35], [1, 36], [1, 37], [1, 38], [2, 39], [2, 40], [1, 41], [2, 42], [2, 43],
                          [2, 44],
                          [1, 45], [2, 46], [2, 47], [1, 48], [1, 49], [1, 50], [1, 51], [2, 52], [1, 53], [2, 54],
                          [2, 55],
                          [1, 56], [1, 57], [2, 58], [2, 59], [1, 60], [2, 61], [1, 62], [2, 63], [1, 64], [2, 65],
                          [2, 66],
                          [2, 67], [2, 68], [2, 69], [1, 70], [2, 71], [2, 72], [2, 73], [1, 74], [2, 75], [2, 76],
                          [2, 77], [1, 78], [1, 79], [1, 80], [1, 81], [1, 82], [1, 83], [2, 84], [2, 85], [1, 86],
                          [2, 87],
                          [1, 88], [1, 89], [2, 90], [2, 91], [1, 92], [2, 93], [1, 94], [2, 95], [1, 96], [2, 97],
                          [1, 98],
                          [2, 99], [2, 100], [2, 101], [2, 102], [1, 103], [2, 104], [2, 105], [2, 106], [2, 107],
                          [2, 108], [2, 109], [2, 110], [1, 111], [2, 112], [2, 113], [2, 114], [2, 115], [2, 116],
                          [1, 117], [2, 118], [1, 119], [2, 120], [1, 121], [1, 122], [1, 123], [1, 124], [1, 125],
                          [2, 126],
                          [2, 127], [2, 128], [1, 129], [2, 130], [2, 131], [2, 132], [1, 133], [2, 134], [1, 135],
                          [2, 136], [2, 137], [1, 138], [2, 139], [1, 140], [2, 141], [1, 142], [1, 143], [1, 144],
                          [2, 145],
                          [2, 146], [1, 147], [2, 148], [1, 149], [1, 150], [1, 151], [2, 152], [1, 153], [2, 154],
                          [1, 155],
                          [2, 156], [2, 157], [1, 158], [2, 159], [2, 160], [1, 161], [1, 162], [1, 163], [2, 164],
                          [2, 165],
                          [2, 166], [2, 167], [1, 168], [1, 169], [1, 170], [1, 171], [2, 172], [2, 173], [2, 174],
                          [2, 175],
                          [2, 176], [2, 177], [2, 178], [1, 179], [2, 180], [2, 181], [2, 182], [1, 183], [2, 184],
                          [1, 185], [2, 186], [1, 187], [2, 188], [2, 189], [1, 190], [2, 191], [2, 192], [2, 193],
                          [1, 194],
                          [1, 195], [2, 196], [1, 197], [2, 198], [2, 199], [1, 200], [2, 201], [2, 202], [2, 203],
                          [1, 204],
                          [2, 205], [1, 206], [2, 207], [2, 208], [1, 209], [2, 210], [2, 211], [2, 212], [2, 213],
                          [2, 214], [2, 215], [1, 216], [1, 217], [1, 218], [2, 219], [2, 220], [1, 221], [1, 222],
                          [1, 223],
                          [2, 224], [1, 225], [2, 226], [2, 227], [1, 228], [1, 229], [2, 230], [1, 231], [1, 232],
                          [1, 233],
                          [2, 234], [2, 235], [2, 236], [1, 237], [2, 238], [1, 239], [2, 240], [2, 241], [2, 242],
                          [1, 243], [1, 244], [2, 245], [2, 246], [1, 247], [1, 248], [2, 249], [1, 250], [2, 251],
                          [1, 252],
                          [1, 253], [1, 254], [1, 255], [1, 256], [1, 257], [1, 258], [2, 259], [2, 260], [2, 261],
                          [1, 262],
                          [1, 263], [2, 264], [2, 265], [2, 266], [2, 267], [2, 268], [1, 269], [2, 270], [2, 271],
                          [2, 272], [1, 273], [2, 274], [2, 275], [2, 276], [1, 277], [1, 278], [2, 279], [1, 280],
                          [2, 281],
                          [1, 282], [2, 283], [1, 284], [1, 285], [1, 286], [1, 287], [1, 288], [1, 289], [2, 290],
                          [1, 291],
                          [2, 292], [2, 293], [2, 294], [2, 295], [2, 296], [2, 297], [2, 298], [1, 299], [2, 300],
                          [1, 301], [2, 302], [1, 303], [2, 304], [2, 305], [1, 306], [2, 307], [1, 308], [1, 309],
                          [2, 310],
                          [2, 311], [1, 312], [1, 313], [1, 314], [2, 315], [1, 316], [1, 317], [1, 318], [1, 319],
                          [2, 320],
                          [1, 321], [2, 322], [2, 323], [2, 324], [1, 325], [2, 326], [1, 327], [2, 328], [1, 329],
                          [2, 330],
                          [1, 331], [1, 332], [2, 333], [2, 334], [2, 335], [1, 336], [2, 337], [2, 338], [1, 339],
                          [2, 340],
                          [2, 341], [2, 342], [2, 343], [1, 344], [2, 345], [1, 346], [2, 347], [2, 348], [2, 349],
                          [2, 350], [1, 351], [1, 352], [2, 353], [2, 354], [2, 355], [2, 356], [1, 357], [2, 358],
                          [1, 359],
                          [2, 360], [2, 361], [2, 362], [2, 363], [1, 364], [1, 365], [1, 366], [2, 367], [1, 368],
                          [2, 369],
                          [1, 370], [2, 371], [2, 372], [1, 373], [1, 374], [2, 375], [2, 376]]

    answer_BAA2_random = [[2, 1], [2, 1], [1, 2], [2, 3], [1, 4], [1, 5], [1, 6], [1, 7], [1, 8], [1, 9], [1, 10],
                          [2, 11],
                          [1, 12], [2, 13], [2, 14], [2, 15], [2, 16], [2, 17], [2, 18], [1, 19], [2, 20], [2, 21],
                          [2, 22], [2, 23], [2, 24], [1, 25], [2, 26], [2, 27], [1, 28], [2, 29], [2, 30], [1, 31],
                          [1, 32],
                          [1, 33], [1, 34], [2, 35], [1, 36], [1, 37], [2, 38], [1, 39], [2, 40], [1, 41], [2, 42],
                          [1, 43],
                          [2, 44], [1, 45], [2, 46], [2, 47], [1, 48], [1, 49], [2, 50], [1, 51], [2, 52], [1, 53],
                          [2, 54],
                          [2, 55], [1, 56], [1, 57], [2, 58], [2, 59], [2, 60], [2, 61], [1, 62], [2, 63], [1, 64],
                          [2, 65],
                          [2, 66], [2, 67], [2, 68], [2, 69], [2, 70], [2, 71], [2, 72], [2, 73], [1, 74], [2, 75],
                          [1, 76], [2, 77], [1, 78], [1, 79], [1, 80], [1, 81], [1, 82], [1, 83], [2, 84], [2, 85],
                          [1, 86],
                          [2, 87], [1, 88], [1, 89], [2, 90], [2, 91], [1, 92], [2, 93], [1, 94], [2, 95], [1, 96],
                          [1, 97],
                          [1, 98], [2, 99], [2, 100], [2, 101], [2, 102], [1, 103], [2, 104], [2, 105], [1, 106],
                          [1, 107],
                          [1, 108], [2, 109], [2, 110], [2, 111], [2, 112], [2, 113], [2, 114], [1, 115], [2, 116],
                          [2, 117], [2, 118], [1, 119], [2, 120], [1, 121], [2, 122], [2, 123], [1, 124], [2, 125],
                          [2, 126], [2, 127], [2, 128], [2, 129], [2, 130], [2, 131], [2, 132], [1, 133], [2, 134],
                          [1, 135], [2, 136], [2, 137], [2, 138], [1, 139], [1, 140], [2, 141], [1, 142], [2, 143],
                          [1, 144],
                          [2, 145], [2, 146], [1, 147], [1, 148], [2, 149], [1, 150], [1, 151], [2, 152], [1, 153],
                          [2, 154],
                          [2, 155], [2, 156], [2, 157], [1, 158], [2, 159], [2, 160], [1, 161], [1, 162], [1, 163],
                          [1, 164],
                          [2, 165], [2, 166], [2, 167], [1, 168], [1, 169], [1, 170], [1, 171], [2, 172], [2, 173],
                          [1, 174],
                          [2, 175], [2, 176], [2, 177], [2, 178], [1, 179], [2, 180], [2, 181], [2, 182], [1, 183],
                          [2, 184], [2, 185], [2, 186], [1, 187], [2, 188], [2, 189], [2, 190], [2, 191], [2, 192],
                          [2, 193], [2, 194], [1, 195], [2, 196], [1, 197], [2, 198], [1, 199], [1, 200], [1, 201],
                          [2, 202],
                          [1, 203], [1, 204], [2, 205], [1, 206], [2, 207], [2, 208], [1, 209], [2, 210], [2, 211],
                          [2, 212],
                          [2, 213], [2, 214], [2, 215], [2, 216], [1, 217], [1, 218], [2, 219], [1, 220], [2, 221],
                          [1, 222],
                          [1, 223], [2, 224], [1, 225], [2, 226], [1, 227], [1, 228], [1, 229], [1, 230], [1, 231],
                          [1, 232],
                          [2, 233], [2, 234], [2, 235], [2, 236], [2, 237], [2, 238], [1, 239], [2, 240], [1, 241],
                          [2, 242], [2, 243], [1, 244], [2, 245], [1, 246], [1, 247], [2, 248], [2, 249], [1, 250],
                          [2, 251],
                          [1, 252], [2, 253], [1, 254], [2, 255], [1, 256], [1, 257], [2, 258], [2, 259], [2, 260],
                          [2, 261],
                          [1, 262], [1, 263], [2, 264], [2, 265], [2, 266], [2, 267], [2, 268], [1, 269], [2, 270],
                          [2, 271], [2, 272], [2, 273], [1, 274], [2, 275], [2, 276], [1, 277], [2, 278], [1, 279],
                          [1, 280],
                          [2, 281], [1, 282], [2, 283], [2, 284], [1, 285], [1, 286], [1, 287], [1, 288], [2, 289],
                          [2, 290],
                          [1, 291], [2, 292], [2, 293], [2, 294], [2, 295], [2, 296], [2, 297], [2, 298], [1, 299],
                          [2, 300], [1, 301], [2, 302], [1, 303], [2, 304], [2, 305], [1, 306], [2, 307], [1, 308],
                          [1, 309],
                          [2, 310], [2, 311], [1, 312], [1, 313], [1, 314], [2, 315], [2, 316], [1, 317], [1, 318],
                          [2, 319],
                          [2, 320], [1, 321], [2, 322], [2, 323], [2, 324], [2, 325], [2, 326], [1, 327], [2, 328],
                          [1, 329], [1, 330], [1, 331], [1, 332], [1, 333], [2, 334], [2, 335], [1, 336], [2, 337],
                          [2, 338],
                          [1, 339], [2, 340], [2, 341], [1, 342], [2, 343], [1, 344], [1, 345], [1, 346], [1, 347],
                          [2, 348],
                          [1, 349], [2, 350], [1, 351], [1, 352], [2, 353], [2, 354], [2, 355], [2, 356], [1, 357],
                          [2, 358],
                          [1, 359], [2, 360], [2, 361], [2, 362], [2, 363], [1, 364], [1, 365], [1, 366], [2, 367],
                          [1, 368],
                          [2, 369], [1, 370], [1, 371], [2, 372], [1, 373], [1, 374], [2, 375], [2, 376]]

    answer_COK_random = [[2, 1],
                         [2, 1],
                         [2, 2],
                         [2, 3],
                         [1, 4],
                         [1, 5],
                         [1, 6],
                         [1, 7],
                         [1, 8],
                         [1, 9],
                         [1, 10],
                         [2, 11],
                         [1, 12],
                         [2, 13],
                         [1, 14],
                         [1, 15],
                         [1, 16],
                         [2, 17],
                         [2, 18],
                         [1, 19],
                         [1, 20],
                         [1, 21],
                         [2, 22],
                         [1, 23],
                         [1, 24],
                         [1, 25],
                         [2, 26],
                         [2, 27],
                         [1, 28],
                         [1, 29],
                         [2, 30],
                         [1, 31],
                         [2, 32],
                         [2, 33],
                         [2, 34],
                         [2, 35],
                         [1, 36],
                         [2, 37],
                         [1, 38],
                         [1, 39],
                         [2, 40],
                         [1, 41],
                         [2, 42],
                         [1, 43],
                         [2, 44],
                         [2, 45],
                         [2, 46],
                         [1, 47],
                         [1, 48],
                         [1, 49],
                         [2, 50],
                         [2, 51],
                         [2, 52],
                         [1, 53],
                         [2, 54],
                         [2, 55],
                         [1, 56],
                         [1, 57],
                         [2, 58],
                         [2, 59],
                         [2, 60],
                         [2, 61],
                         [2, 62],
                         [2, 63],
                         [1, 64],
                         [2, 65],
                         [2, 66],
                         [1, 67],
                         [2, 68],
                         [1, 69],
                         [2, 70],
                         [1, 71],
                         [2, 72],
                         [2, 73],
                         [1, 74],
                         [2, 75],
                         [2, 76],
                         [2, 77],
                         [1, 78],
                         [1, 79],
                         [1, 80],
                         [2, 81],
                         [1, 82],
                         [1, 83],
                         [2, 84],
                         [2, 85],
                         [1, 86],
                         [1, 87],
                         [1, 88],
                         [1, 89],
                         [2, 90],
                         [2, 91],
                         [2, 92],
                         [1, 93],
                         [1, 94],
                         [2, 95],
                         [1, 96],
                         [1, 97],
                         [1, 98],
                         [2, 99],
                         [1, 100],
                         [2, 101],
                         [1, 102],
                         [2, 103],
                         [2, 104],
                         [2, 105],
                         [2, 106],
                         [1, 107],
                         [1, 108],
                         [1, 109],
                         [2, 110],
                         [1, 111],
                         [2, 112],
                         [2, 113],
                         [2, 114],
                         [2, 115],
                         [2, 116],
                         [1, 117],
                         [2, 118],
                         [2, 119],
                         [2, 120],
                         [1, 121],
                         [2, 122],
                         [1, 123],
                         [2, 124],
                         [1, 125],
                         [2, 126],
                         [2, 127],
                         [2, 128],
                         [2, 129],
                         [2, 130],
                         [1, 131],
                         [2, 132],
                         [1, 133],
                         [2, 134],
                         [1, 135],
                         [2, 136],
                         [2, 137],
                         [2, 138],
                         [1, 139],
                         [2, 140],
                         [2, 141],
                         [1, 142],
                         [2, 143],
                         [1, 144],
                         [2, 145],
                         [2, 146],
                         [1, 147],
                         [1, 148],
                         [2, 149],
                         [1, 150],
                         [2, 151],
                         [2, 152],
                         [1, 153],
                         [2, 154],
                         [2, 155],
                         [2, 156],
                         [2, 157],
                         [1, 158],
                         [2, 159],
                         [2, 160],
                         [2, 161],
                         [2, 162],
                         [1, 163],
                         [1, 164],
                         [2, 165],
                         [2, 166],
                         [2, 167],
                         [1, 168],
                         [1, 169],
                         [1, 170],
                         [1, 171],
                         [2, 172],
                         [2, 173],
                         [2, 174],
                         [2, 175],
                         [1, 176],
                         [1, 177],
                         [2, 178],
                         [2, 179],
                         [1, 180],
                         [1, 181],
                         [2, 182],
                         [2, 183],
                         [2, 184],
                         [2, 185],
                         [2, 186],
                         [1, 187],
                         [1, 188],
                         [2, 189],
                         [1, 190],
                         [2, 191],
                         [2, 192],
                         [2, 193],
                         [2, 194],
                         [1, 195],
                         [2, 196],
                         [2, 197],
                         [1, 198],
                         [2, 199],
                         [1, 200],
                         [1, 201],
                         [2, 202],
                         [2, 203],
                         [1, 204],
                         [2, 205],
                         [2, 206],
                         [2, 207],
                         [2, 208],
                         [1, 209],
                         [2, 210],
                         [2, 211],
                         [1, 212],
                         [2, 213],
                         [2, 214],
                         [2, 215],
                         [1, 216],
                         [2, 217],
                         [1, 218],
                         [1, 219],
                         [2, 220],
                         [2, 221],
                         [2, 222],
                         [2, 223],
                         [1, 224],
                         [1, 225],
                         [2, 226],
                         [2, 227],
                         [1, 228],
                         [1, 229],
                         [1, 230],
                         [2, 231],
                         [1, 232],
                         [2, 233],
                         [2, 234],
                         [1, 235],
                         [2, 236],
                         [1, 237],
                         [2, 238],
                         [1, 239],
                         [2, 240],
                         [2, 241],
                         [1, 242],
                         [2, 243],
                         [2, 244],
                         [2, 245],
                         [2, 246],
                         [2, 247],
                         [2, 248],
                         [1, 249],
                         [2, 250],
                         [2, 251],
                         [1, 252],
                         [2, 253],
                         [2, 254],
                         [2, 255],
                         [1, 256],
                         [2, 257],
                         [2, 258],
                         [2, 259],
                         [1, 260],
                         [2, 261],
                         [1, 262],
                         [2, 263],
                         [2, 264],
                         [2, 265],
                         [2, 266],
                         [2, 267],
                         [1, 268],
                         [1, 269],
                         [1, 270],
                         [2, 271],
                         [2, 272],
                         [2, 273],
                         [1, 274],
                         [2, 275],
                         [2, 276],
                         [1, 277],
                         [2, 278],
                         [1, 279],
                         [2, 280],
                         [1, 281],
                         [1, 282],
                         [1, 283],
                         [2, 284],
                         [2, 285],
                         [2, 286],
                         [2, 287],
                         [2, 288],
                         [2, 289],
                         [1, 290],
                         [2, 291],
                         [1, 292],
                         [2, 293],
                         [2, 294],
                         [1, 295],
                         [1, 296],
                         [2, 297],
                         [2, 298],
                         [1, 299],
                         [2, 300],
                         [1, 301],
                         [2, 302],
                         [1, 303],
                         [2, 304],
                         [2, 305],
                         [2, 306],
                         [2, 307],
                         [2, 308],
                         [1, 309],
                         [2, 310],
                         [1, 311],
                         [2, 312],
                         [1, 313],
                         [1, 314],
                         [2, 315],
                         [2, 316],
                         [2, 317],
                         [2, 318],
                         [2, 319],
                         [2, 320],
                         [1, 321],
                         [1, 322],
                         [1, 323],
                         [2, 324],
                         [2, 325],
                         [2, 326],
                         [1, 327],
                         [2, 328],
                         [1, 329],
                         [2, 330],
                         [1, 331],
                         [2, 332],
                         [2, 333],
                         [2, 334],
                         [2, 335],
                         [1, 336],
                         [2, 337],
                         [2, 338],
                         [1, 339],
                         [1, 340],
                         [2, 341],
                         [2, 342],
                         [1, 343],
                         [2, 344],
                         [2, 345],
                         [2, 346],
                         [1, 347],
                         [2, 348],
                         [1, 349],
                         [2, 350],
                         [1, 351],
                         [1, 352],
                         [2, 353],
                         [2, 354],
                         [1, 355],
                         [2, 356],
                         [1, 357],
                         [2, 358],
                         [1, 359],
                         [2, 360],
                         [2, 361],
                         [2, 362],
                         [2, 363],
                         [2, 364],
                         [1, 365],
                         [1, 366],
                         [2, 367],
                         [2, 368],
                         [1, 369],
                         [1, 370],
                         [1, 371],
                         [2, 372],
                         [1, 373],
                         [2, 374],
                         [2, 375],
                         [1, 376],
                         ]

    answer_KOEA1_random = [[2, 1],
                           [1, 1],
                           [1, 2],
                           [1, 3],
                           [2, 4],
                           [1, 5],
                           [1, 6],
                           [1, 7],
                           [1, 8],
                           [1, 9],
                           [1, 10],
                           [2, 11],
                           [1, 12],
                           [1, 13],
                           [1, 14],
                           [2, 15],
                           [2, 16],
                           [2, 17],
                           [1, 18],
                           [2, 19],
                           [1, 20],
                           [2, 21],
                           [2, 22],
                           [1, 23],
                           [2, 24],
                           [1, 25],
                           [2, 26],
                           [2, 27],
                           [1, 28],
                           [2, 29],
                           [2, 30],
                           [2, 31],
                           [1, 32],
                           [1, 33],
                           [1, 34],
                           [2, 35],
                           [1, 36],
                           [1, 37],
                           [2, 38],
                           [1, 39],
                           [2, 40],
                           [1, 41],
                           [2, 42],
                           [1, 43],
                           [1, 44],
                           [1, 45],
                           [2, 46],
                           [2, 47],
                           [1, 48],
                           [2, 49],
                           [2, 50],
                           [2, 51],
                           [2, 52],
                           [2, 53],
                           [2, 54],
                           [2, 55],
                           [1, 56],
                           [1, 57],
                           [2, 58],
                           [2, 59],
                           [2, 60],
                           [2, 61],
                           [2, 62],
                           [2, 63],
                           [2, 64],
                           [2, 65],
                           [2, 66],
                           [1, 67],
                           [1, 68],
                           [2, 69],
                           [2, 70],
                           [2, 71],
                           [2, 72],
                           [2, 73],
                           [1, 74],
                           [1, 75],
                           [2, 76],
                           [2, 77],
                           [1, 78],
                           [1, 79],
                           [1, 80],
                           [2, 81],
                           [2, 82],
                           [2, 83],
                           [2, 84],
                           [2, 85],
                           [2, 86],
                           [1, 87],
                           [1, 88],
                           [1, 89],
                           [2, 90],
                           [2, 91],
                           [2, 92],
                           [1, 93],
                           [1, 94],
                           [2, 95],
                           [1, 96],
                           [2, 97],
                           [2, 98],
                           [2, 99],
                           [1, 100],
                           [2, 101],
                           [2, 102],
                           [2, 103],
                           [2, 104],
                           [1, 105],
                           [2, 106],
                           [1, 107],
                           [2, 108],
                           [1, 109],
                           [2, 110],
                           [2, 111],
                           [2, 112],
                           [2, 113],
                           [1, 114],
                           [2, 115],
                           [2, 116],
                           [2, 117],
                           [2, 118],
                           [1, 119],
                           [2, 120],
                           [2, 121],
                           [1, 122],
                           [1, 123],
                           [2, 124],
                           [1, 125],
                           [2, 126],
                           [2, 127],
                           [2, 128],
                           [2, 129],
                           [1, 130],
                           [2, 131],
                           [1, 132],
                           [1, 133],
                           [2, 134],
                           [1, 135],
                           [2, 136],
                           [2, 137],
                           [2, 138],
                           [2, 139],
                           [2, 140],
                           [2, 141],
                           [1, 142],
                           [2, 143],
                           [2, 144],
                           [2, 145],
                           [2, 146],
                           [2, 147],
                           [1, 148],
                           [2, 149],
                           [1, 150],
                           [2, 151],
                           [2, 152],
                           [1, 153],
                           [2, 154],
                           [2, 155],
                           [2, 156],
                           [2, 157],
                           [2, 158],
                           [1, 159],
                           [2, 160],
                           [1, 161],
                           [1, 162],
                           [2, 163],
                           [1, 164],
                           [2, 165],
                           [2, 166],
                           [2, 167],
                           [1, 168],
                           [1, 169],
                           [1, 170],
                           [1, 171],
                           [2, 172],
                           [2, 173],
                           [2, 174],
                           [2, 175],
                           [2, 176],
                           [2, 177],
                           [2, 178],
                           [2, 179],
                           [2, 180],
                           [2, 181],
                           [2, 182],
                           [1, 183],
                           [2, 184],
                           [2, 185],
                           [2, 186],
                           [1, 187],
                           [1, 188],
                           [1, 189],
                           [2, 190],
                           [2, 191],
                           [2, 192],
                           [1, 193],
                           [2, 194],
                           [2, 195],
                           [2, 196],
                           [2, 197],
                           [2, 198],
                           [2, 199],
                           [1, 200],
                           [1, 201],
                           [2, 202],
                           [2, 203],
                           [1, 204],
                           [2, 205],
                           [2, 206],
                           [2, 207],
                           [1, 208],
                           [1, 209],
                           [1, 210],
                           [2, 211],
                           [2, 212],
                           [2, 213],
                           [1, 214],
                           [1, 215],
                           [2, 216],
                           [1, 217],
                           [1, 218],
                           [2, 219],
                           [2, 220],
                           [1, 221],
                           [2, 222],
                           [1, 223],
                           [2, 224],
                           [1, 225],
                           [2, 226],
                           [2, 227],
                           [1, 228],
                           [1, 229],
                           [2, 230],
                           [2, 231],
                           [2, 232],
                           [2, 233],
                           [2, 234],
                           [1, 235],
                           [2, 236],
                           [2, 237],
                           [1, 238],
                           [2, 239],
                           [2, 240],
                           [2, 241],
                           [2, 242],
                           [2, 243],
                           [1, 244],
                           [2, 245],
                           [2, 246],
                           [1, 247],
                           [1, 248],
                           [2, 249],
                           [2, 250],
                           [2, 251],
                           [1, 252],
                           [2, 253],
                           [1, 254],
                           [2, 255],
                           [2, 256],
                           [1, 257],
                           [1, 258],
                           [2, 259],
                           [1, 260],
                           [2, 261],
                           [1, 262],
                           [1, 263],
                           [2, 264],
                           [2, 265],
                           [2, 266],
                           [2, 267],
                           [2, 268],
                           [2, 269],
                           [1, 270],
                           [2, 271],
                           [1, 272],
                           [2, 273],
                           [2, 274],
                           [2, 275],
                           [2, 276],
                           [1, 277],
                           [2, 278],
                           [2, 279],
                           [2, 280],
                           [2, 281],
                           [1, 282],
                           [2, 283],
                           [1, 284],
                           [2, 285],
                           [2, 286],
                           [2, 287],
                           [2, 288],
                           [2, 289],
                           [2, 290],
                           [1, 291],
                           [2, 292],
                           [2, 293],
                           [2, 294],
                           [2, 295],
                           [2, 296],
                           [2, 297],
                           [2, 298],
                           [1, 299],
                           [2, 300],
                           [2, 301],
                           [1, 302],
                           [2, 303],
                           [2, 304],
                           [2, 305],
                           [2, 306],
                           [2, 307],
                           [1, 308],
                           [2, 309],
                           [2, 310],
                           [1, 311],
                           [2, 312],
                           [1, 313],
                           [1, 314],
                           [2, 315],
                           [1, 316],
                           [1, 317],
                           [2, 318],
                           [2, 319],
                           [2, 320],
                           [1, 321],
                           [1, 322],
                           [2, 323],
                           [2, 324],
                           [2, 325],
                           [2, 326],
                           [2, 327],
                           [2, 328],
                           [1, 329],
                           [2, 330],
                           [2, 331],
                           [2, 332],
                           [2, 333],
                           [1, 334],
                           [2, 335],
                           [1, 336],
                           [2, 337],
                           [2, 338],
                           [1, 339],
                           [2, 340],
                           [2, 341],
                           [2, 342],
                           [2, 343],
                           [2, 344],
                           [2, 345],
                           [2, 346],
                           [1, 347],
                           [2, 348],
                           [2, 349],
                           [2, 350],
                           [1, 351],
                           [2, 352],
                           [2, 353],
                           [2, 354],
                           [2, 355],
                           [2, 356],
                           [1, 357],
                           [1, 358],
                           [2, 359],
                           [2, 360],
                           [2, 361],
                           [2, 362],
                           [2, 363],
                           [1, 364],
                           [2, 365],
                           [1, 366],
                           [2, 367],
                           [1, 368],
                           [2, 369],
                           [1, 370],
                           [1, 371],
                           [1, 372],
                           [2, 373],
                           [2, 374],
                           [2, 375],
                           [2, 376]
                           ]


def calculate_all_matches(answer_list, gender):
    scale_m_L = [-49, -57, -64, -89, -119, -149, -162, -179, -209, -230, -239, -269, -299, -329, -359]
    scale_m_F = [11, -23, 24, 25, 26, 27, 53, 54, 55, -56, -57, 71, 82, -83, 84, 85, -86, 101, 104, 112, 114, 115, 116,
                 131,
                 142, 144, 145, 146, 172, 174, -175, 176, -192, 202, -204, 205, 206, -232, -234, 235, 236, -260, -262,
                 264,
                 265, 266, -292, 293, 294, -295, 296, -322, 323, 324, 325, 326, 333, 352, 353, 354, 355, 356, -363, ]
    scale_m_K = [-7, -12, -37, -42, -72, -93, -97, -102, -123, -127, 132, -153, -157, -162, -187, -192, -216, -217,
                 -222,
                 -252, -276, -279, -281, -282, -309, -311, -312, 339, -341, -371]
    scale_m_Hs = [14, -15, 16, 44, 45, -46, -74, 76, 104, -106, -130, 134, 136, 164, -166, -194, 196, 224, -253, 254,
                  -283, 284, 285, 307, 313, 314, 315, 343, 344, 345, -373, 374, 375]
    scale_m_D = [8, -17, 18, -19, -40, -42, 47, 48, -49, -74, -77, 78, 97, 104, 107, 108, -123, -130, -136, -137, 138,
                 -160, -162, 164, -166, 167, 168, -192, -197, -198, -222, 224, -226, 227, 228, -243, 252, -253, 256,
                 257, 258, -276, -283, -286, -287, -288, 314, -316, -317, -318, 336, -337, -346, -347, -348, 366, -367,
                 -369, -376]
    scale_m_Hy = [-7, -10, 13, 14, -15, -37, -40, -42, -43, 44, 45, -70, -72, -73, -74, 75, -100, -102, -103, 104, 105,
                  -123, -132, 133, 134, 135, -154, -162, -163, 164, 165, -183, -186, 193, -194, -195, -213, -217, -223,
                  224,
                  -225, -247, -253, 254, -255, -277, -279, -283, 284, 313, 314, 336, -342, 343, 344, -369, 372, -373,
                  374]
    scale_m_Pd = [-7, -9, -10, 11, -37, 39, -40, 41, 63, -67, 69, -70, 71, -93, 99, -100, 101, -129, -130, 131, -159,
                  -160,
                  161, -186, 189, 190, 191, -216, -219, 220, 221, 246, 249, 250, 251, -276, -279, 280, -306, -309, 310,
                  336,
                  -339, 340, 366, 368, -369, 370]
    scale_m_Mf = [1, -1, 2, -3, 4, -30, 31, -32, -33, -34, -60, 61, -62, 63, -64, -90, -91, -92, 93, -120, 121, -122,
                  -123,
                  150, 151, -152, 153, 180, -181, -182, -183, -210, -211, 212, -213, -240, 241, 242, -243, -270, -271,
                  272,
                  273, 300, 301, 302, 330, 331, -332, 333, 360, 361, -362, -363]
    scale_m_Pa = [4, 11, 27, -33, 41, 50, 87, 112, 113, -117, 142, 143, -147, 161, 170, 177, -187, 191, -195, 202, 207,
                  -217, 221, -225, 230, -237, 251, 258, 261, 266, -267, 290, 296, -297, 307, 326, 338, 356, -369, 370]
    scale_m_Pt = [18, 20, 38, -40, 48, 50, 68, 75, 78, 79, 80, 98, 105, 108, 109, 110, 128, 135, 139, 140, 153, 158,
                  169,
                  170, 188, 190, -194, -199, 200, 218, 220, 229, 230, 250, 252, 257, 259, -260, -287, 289, 290, 314,
                  -317,
                  319, 336, -347, 349, 366]
    scale_m_Sc = [11, 20, 21, 22, -23, -40, 41, 50, 51, 52, 53, 78, 80, 81, 82, -83, 105, 108, 110, 111, 112, 113, 135,
                  138,
                  140, 141, 142, 143, 165, 168, 170, 171, 172, 173, 196, 198, 200, 201, 202, 203, 228, 230, 231, -232,
                  233,
                  246, -248, 257, 261, -262, 263, 273, 278, 280, -282, -291, -292, 303, 307, 308, 310, 320, -321, -322,
                  336,
                  340, 344, -347, 349, 350, 351, 352, 370, 374]
    scale_m_Ma = [-7, 19, 20, 28, -29, -34, -37, 50, 58, 59, -70, -88, -89, 93, 105, 107, 118, -119, 148, 173, 178, 195,
                  203, 208, -216, 221, 233, 238, -248, 255, 261, 263, 268, 275, 280, 288, 297, 298, -312, 318, 327, 338,
                  348, 352, -357, 358]
    scale_m_Si = [-3, 5, 6, 7, 8, 33, -35, 36, 37, 38, -65, -66, -67, 68, 94, -95, 96, 97, 98, -124, 125, 126, 127, 128,
                  154, -155, -156, 157, 158, -184, -185, 186, 187, -188, -214, -215, 216, 217, 218, 242, 244, -245,
                  -246,
                  247, -248, -272, -274, -275, -276, 277, 278, -302, 304, -305, 306, 307, 308, -332, -334, -335, 336,
                  337,
                  -338, -362, 364, 365, 366, -367]

    results = {
        'L': calculate_matches(scale_m_L, answer_list),
        'F': calculate_matches(scale_m_F, answer_list),
        'K': calculate_matches(scale_m_K, answer_list),
        'Hs': calculate_matches(scale_m_Hs, answer_list),
        'D': calculate_matches(scale_m_D, answer_list),
        'Hy': calculate_matches(scale_m_Hy, answer_list),
        'Pd': calculate_matches(scale_m_Pd, answer_list),
        'Mf': calculate_matches(scale_m_Mf, answer_list),
        'Pa': calculate_matches(scale_m_Pa, answer_list),
        'Pt': calculate_matches(scale_m_Pt, answer_list),
        'Sc': calculate_matches(scale_m_Sc, answer_list),
        'Ma': calculate_matches(scale_m_Ma, answer_list),
        'Si': calculate_matches(scale_m_Si, answer_list)
    }

    k_value = results['K']['matched_count']

    results['Hs']['matched_count'] += int(k_value * 0.5)
    results['Pd']['matched_count'] += int(k_value * 0.4)
    results['Ma']['matched_count'] += int(k_value * 0.2)
    results['Pt']['matched_count'] += k_value
    results['Sc']['matched_count'] += k_value

    # Нормы для шкалы L
    norms_M = {
        'L': {
            0: 32, 1: 37, 2: 41, 3: 46, 4: 50, 5: 56, 6: 59, 7: 64,
            8: 65, 9: 73, 10: 77, 11: 82, 12: 86, 13: 91
        },
        'F': {
            0: 30, 1: 34, 2: 37, 3: 40, 4: 44, 5: 47, 6: 51, 7: 54,
            8: 58, 9: 61, 10: 64, 11: 68, 12: 71, 13: 74, 14: 78,
            15: 81, 16: 85,

        },
        'K': {
            0: 9, 1: 12, 2: 14, 3: 17, 4: 19, 5: 22, 6: 24, 7: 27,
            8: 30, 9: 32, 10: 35, 11: 38, 12: 40, 13: 43, 14: 45,
            15: 47, 16: 50, 17: 53, 18: 56, 19: 58, 20: 61, 21: 64,
            22: 66, 23: 69, 24: 71, 25: 74, 26: 76, 27: 79, 28: 82,
            29: 84, 30: 87
        },
        'Hs': {
            0: 14, 1: 17, 2: 20, 3: 23, 4: 26, 5: 29, 6: 32, 7: 35,
            8: 38, 9: 41, 10: 44, 11: 47, 12: 50, 13: 53, 14: 56,
            15: 58, 16: 62, 17: 65, 18: 68, 19: 71, 20: 74, 21: 77,
            22: 80, 23: 83, 24: 84, 25: 89, 26: 92, 27: 95, 28: 98,
            29: 101, 30: 104, 31: 107, 32: 110, 33: 113, 34: 116,
            35: 110, 36: 122
        },
        'D': {
            8: 21, 9: 24, 10: 26, 11: 28, 12: 31, 13: 33, 14: 36,
            15: 38, 16: 40, 17: 43, 18: 45, 19: 48, 20: 50, 21: 52,
            22: 55, 23: 57, 24: 60, 25: 62, 26: 64, 27: 67, 28: 69,
            29: 72, 30: 74, 31: 76, 32: 79, 33: 81, 34: 84, 35: 86,
            36: 88, 37: 91, 38: 93, 39: 96, 40: 98, 41: 100, 42: 103,
            43: 105, 44: 108, 45: 110
        },
        'Hy': {
            10: 31, 11: 34, 12: 36, 13: 38, 14: 41, 15: 43, 16: 45,
            17: 48, 18: 50, 19: 52, 20: 54, 21: 57, 22: 59, 23: 61,
            24: 64, 25: 66, 26: 68, 27: 70, 28: 72, 29: 75, 30: 77,
            31: 80, 32: 82, 33: 84, 34: 87, 35: 89, 36: 91, 37: 93,
            38: 96, 39: 98, 40: 100, 41: 103, 42: 105, 43: 107,
            44: 110, 45: 112, 46: 114, 47: 116, 48: 119, 49: 121
        },
        'Pd': {
            9: 21, 10: 23, 11: 26, 12: 28, 13: 30, 14: 33, 15: 35,
            16: 38, 17: 40, 18: 42, 19: 45, 20: 47, 21: 50, 22: 52,
            23: 54, 24: 57, 25: 59, 26: 62, 27: 64, 28: 66, 29: 69,
            30: 71, 31: 74, 32: 76, 33: 78, 34: 81, 35: 83, 36: 86,
            37: 88, 38: 90, 39: 93, 40: 95, 41: 98, 42: 100, 43: 102,
            44: 105, 45: 107, 46: 110, 47: 112, 48: 114, 49: 117,
            50: 119, 51: 122
        },
        'Mf': {
            13: 22, 14: 25, 15: 28, 16: 31, 17: 34, 18: 38, 19: 41,
            20: 44, 21: 47, 22: 50, 23: 53, 24: 56, 25: 59, 26: 62,
            27: 66, 28: 69, 29: 72, 30: 75, 31: 78, 32: 81, 33: 84,
            34: 87, 35: 90, 36: 93, 37: 96, 38: 100, 39: 103, 40: 106,
            41: 109, 42: 112, 43: 115, 44: 118, 45: 121
        },
        'Pa': {
            0: 17, 1: 20, 2: 24, 3: 28, 4: 31, 5: 35, 6: 38, 7: 42,
            8: 46, 9: 49, 10: 53, 11: 56, 12: 60, 13: 64, 14: 67,
            15: 71, 16: 74, 17: 78, 18: 82, 19: 85, 20: 89, 21: 92,
            22: 96, 23: 100, 24: 103, 25: 107, 26: 110, 27: 114,
            28: 113, 29: 121
        },
        'Pt': {
            13: 20, 14: 22, 15: 24, 16: 26, 17: 28, 18: 30, 19: 32,
            20: 34, 21: 37, 22: 39, 23: 41, 24: 43, 25: 45, 26: 47,
            27: 49, 28: 50, 29: 53, 30: 56, 31: 58, 32: 60, 33: 62,
            34: 64, 35: 66, 36: 68, 37: 70, 38: 72, 39: 74, 40: 76,
            41: 79, 42: 81, 43: 83, 44: 85, 45: 87, 46: 89, 47: 91,
            48: 93, 49: 95, 50: 98, 51: 100, 52: 102, 53: 104,
            54: 106, 55: 108, 56: 110, 57: 112, 58: 114, 59: 116,
            60: 118, 61: 121
        },
        'Sc': {
            13: 20, 14: 22, 15: 24, 16: 26, 17: 29, 18: 31, 19: 33,
            20: 35, 21: 38, 22: 40, 23: 42, 24: 44, 25: 46, 26: 48,
            27: 51, 28: 53, 29: 55, 30: 57, 31: 60, 32: 62, 33: 64,
            34: 66, 35: 68, 36: 70, 37: 73, 38: 75, 39: 77, 40: 79,
            41: 82, 42: 84, 43: 86, 44: 88, 45: 90, 46: 92, 47: 95,
            48: 97, 49: 99, 50: 101, 51: 104, 52: 106, 53: 108,
            54: 110, 55: 112, 56: 114, 57: 117, 58: 119, 59: 121
        },
        'Ma': {
            7: 21, 8: 24, 9: 26, 10: 28, 11: 31, 12: 34, 13: 36,
            14: 38, 15: 41, 16: 44, 17: 46, 18: 48, 19: 51, 20: 54,
            21: 56, 22: 58, 23: 61, 24: 64, 25: 66, 26: 68, 27: 71,
            28: 74, 29: 76, 30: 79, 31: 81, 32: 84, 33: 86, 34: 88,
            35: 91, 36: 94, 37: 96, 38: 98, 39: 101, 40: 104,
            41: 106, 42: 108, 43: 111, 44: 114, 45: 116, 46: 118,
            47: 121
        },
        'Si': {
            5: 20,
            6: 21,
            7: 22,
            8: 24,
            9: 25,
            10: 26,
            11: 28,
            12: 29,
            13: 31,
            14: 32,
            15: 34,
            16: 35,
            17: 36,
            18: 38,
            19: 39,
            20: 40,
            21: 42,
            22: 43,
            23: 45,
            24: 46,
            25: 48,
            26: 49,
            27: 50,
            28: 52,
            29: 53,
            30: 54,
            31: 56,
            32: 57,
            33: 58,
            34: 60,
            35: 62,
            36: 63,
            37: 64,
            38: 66,
            39: 67,
            40: 68,
            41: 70,
            42: 71,
            43: 73,
            44: 74,
            45: 76,
            46: 77,
            47: 78,
            48: 80,
            49: 81,
            50: 82,
            51: 84,
            52: 85,
            53: 87,
            54: 88,
            55: 90,
            56: 91,
            57: 92,
            58: 94,
            59: 95,
            60: 96,
            61: 98,
            62: 99,
            63: 101,
            64: 102,
            65: 104,
        }
    }

    norms_F = {
        'L': {
            0: 31, 1: 35, 2: 39, 3: 43, 4: 48, 5: 52, 6: 57, 7: 61,
            8: 65, 9: 69, 10: 74, 11: 76, 12: 82, 13: 86
        },
        'F': {
            0: 29, 1: 32, 2: 35, 3: 38, 4: 41, 5: 44, 6: 48, 7: 51,
            8: 54, 9: 57, 10: 60, 11: 63, 12: 66, 13: 68, 14: 72,
            15: 75, 16: 79
        },
        'K': {
            2: 20, 3: 22, 4: 24, 5: 27, 6: 29, 7: 32, 8: 34, 9: 37,
            10: 39, 11: 41, 12: 44, 13: 46, 14: 49, 15: 51, 16: 53,
            17: 56, 18: 58, 19: 61, 20: 63, 21: 65, 22: 68, 23: 70,
            24: 73, 25: 75, 26: 77, 27: 80, 28: 82, 29: 85, 30: 87
        },
        'Hs': {
            1: 20, 2: 22, 3: 25, 4: 27, 5: 29, 6: 31, 7: 34, 8: 36,
            9: 38, 10: 40, 11: 42, 12: 44, 13: 47, 14: 49, 15: 51,
            16: 53, 17: 56, 18: 58, 19: 60, 20: 62, 21: 64, 22: 66,
            23: 69, 24: 71, 25: 73, 26: 75, 27: 78, 28: 80, 29: 83,
            30: 84, 31: 86, 32: 88, 33: 90, 34: 93, 35: 95, 36: 97,
            37: 100, 38: 102, 39: 104, 40: 106, 41: 108, 42: 110,
            43: 113, 44: 115, 45: 117, 46: 119, 47: 122
        },
        'D': {
            10: 21, 11: 23, 12: 25, 13: 27, 14: 29, 15: 31, 16: 33,
            17: 35, 18: 37, 19: 39, 20: 41, 21: 43, 22: 45, 23: 47,
            24: 43, 25: 51, 26: 53, 27: 56, 28: 57, 29: 58, 30: 61,
            31: 63, 32: 65, 33: 67, 34: 69, 35: 71, 36: 73, 37: 75,
            38: 77, 39: 79, 40: 81, 41: 83, 42: 85, 43: 87, 44: 89,
            45: 91, 46: 93, 47: 95, 48: 97, 49: 99, 50: 101, 51: 103,
            52: 105, 53: 107, 54: 109, 55: 111
        },
        'Hy': {
            5: 20, 6: 23, 7: 25, 8: 27, 9: 29, 10: 30, 11: 32, 12: 34,
            13: 36, 14: 38, 15: 40, 16: 42, 17: 44, 18: 46, 19: 48,
            20: 49, 21: 51, 22: 53, 23: 55, 24: 57, 25: 59, 26: 61,
            27: 63, 28: 65, 29: 67, 30: 68, 31: 70, 32: 72, 33: 74,
            34: 76, 35: 79, 36: 80, 37: 82, 38: 83, 39: 86, 40: 87,
            41: 89, 42: 91, 43: 93, 44: 95, 45: 97, 46: 99, 47: 101,
            48: 103, 49: 105, 50: 106, 51: 109, 52: 110, 53: 112,
            54: 114, 55: 115
        },
        'Pd': {
            10: 22, 11: 24, 12: 26, 13: 28, 14: 31, 15: 33, 16: 36,
            17: 38, 18: 40, 19: 43, 20: 45, 21: 48, 22: 50, 23: 52,
            24: 55, 25: 57, 26: 60, 27: 62, 28: 64, 29: 67, 30: 69,
            31: 72, 32: 74, 33: 76, 34: 79, 35: 81, 36: 84, 37: 86,
            38: 88, 39: 91, 40: 93, 41: 96, 42: 98, 43: 100, 44: 103,
            45: 105, 46: 108, 47: 110, 48: 112, 49: 115, 50: 117,
            51: 120
        },
        'Mf': {
            15: 95, 16: 92, 17: 89, 18: 86, 19: 84, 20: 81, 21: 79,
            22: 76, 23: 73, 24: 71, 25: 68, 26: 65, 27: 63, 28: 60,
            29: 58, 30: 55, 31: 53, 32: 50, 33: 47, 34: 45, 35: 42,
            36: 40, 37: 37, 38: 34, 39: 32, 40: 29, 41: 27, 42: 24,
            43: 21, 44: 19
        },
        'Pa': {
            1: 22, 2: 24, 3: 28, 4: 30, 5: 34, 6: 36, 7: 40, 8: 42,
            9: 46, 10: 48, 11: 52, 12: 54, 13: 58, 14: 60, 15: 64,
            16: 66, 17: 70, 18: 72, 19: 76, 20: 78, 21: 82, 22: 84,
            23: 88, 24: 90, 25: 94, 26: 96, 27: 100, 28: 102, 29: 106,
            30: 108, 31: 112, 32: 114, 33: 118, 34: 120
        },
        'Pt': {
            18: 21, 19: 23, 20: 25, 21: 27, 22: 29, 23: 32, 24: 34,
            25: 36, 26: 38, 27: 40, 28: 42, 29: 44, 30: 46, 31: 48,
            32: 50, 33: 53, 34: 55, 35: 58, 36: 59, 37: 61, 38: 63,
            39: 65, 40: 67, 41: 69, 42: 71, 43: 74, 44: 76, 45: 78,
            46: 80, 47: 82, 48: 84, 49: 86, 50: 88, 51: 90, 52: 92,
            53: 95, 54: 97, 55: 99, 56: 101, 57: 103, 58: 105, 59: 107,
            60: 109, 61: 111, 62: 113, 63: 116, 64: 118, 65: 120
        },
        'Sc': {
            13: 20, 14: 21, 15: 23, 16: 25, 17: 27, 18: 29, 19: 31,
            20: 33, 21: 35, 22: 37, 23: 38, 24: 40, 25: 42, 26: 43,
            27: 45, 28: 47, 29: 49, 30: 51, 31: 53, 32: 55, 33: 56,
            34: 58, 35: 60, 36: 62, 37: 64, 38: 66, 39: 68, 40: 70,
            41: 72, 42: 74, 43: 76, 44: 77, 45: 79, 46: 81, 47: 83,
            48: 85, 49: 87, 50: 89, 51: 90, 52: 93, 53: 94, 54: 96,
            55: 98, 56: 100, 57: 102, 58: 104, 59: 106, 60: 108,
            61: 110, 62: 112, 63: 114, 64: 115
        },
        'Ma': {
            8: 21, 9: 24, 10: 27, 11: 29, 12: 32, 13: 34, 14: 37,
            15: 40, 16: 42, 17: 45, 18: 47, 19: 50, 20: 53, 21: 55,
            22: 58, 23: 60, 24: 63, 25: 66, 26: 68, 27: 71, 28: 73,
            29: 76, 30: 79, 31: 81, 32: 84, 33: 86, 34: 89, 35: 92,
            36: 94, 37: 97, 38: 99, 39: 102, 40: 105, 41: 107, 42: 110,
            43: 112, 44: 115, 45: 118, 46: 120
        },
        'Si': {
            7: 20, 8: 21, 9: 22, 10: 24, 11: 25, 12: 26, 13: 27,
            14: 29, 15: 30, 16: 31, 17: 33, 18: 34, 19: 35, 20: 36,
            21: 38, 22: 39, 23: 40, 24: 42, 25: 43, 26: 44, 27: 46,
            28: 47, 29: 48, 30: 50, 31: 51, 32: 52, 33: 53, 34: 55,
            35: 56, 36: 57, 37: 59, 38: 60, 39: 61, 40: 62, 41: 64,
            42: 65, 43: 66, 44: 68, 45: 69, 46: 70, 47: 72, 48: 73,
            49: 74, 50: 76, 51: 77, 52: 78, 53: 79, 54: 81, 55: 82, 56: 83,
            57: 84, 58: 86, 59: 87, 60: 88, 61: 90, 62: 91, 63: 92,
            64: 94, 65: 95, 66: 96, 67: 98, 68: 99, 69: 100, 70: 101
        }
    }

    data_norms = {}

    for scale, scale_name in {'L': ' Тенденциозность/ Декларируемая гиперсоциальность',
                              'F': ' Поиск помощи/ Аггравация',
                              'K': ' Конформность/ Социальная неловкость',
                              'Hs': ' Соматизация тревоги',
                              'D': ' Тревога и депрессивные тенденции',
                              'Hy': ' Вытеснение факторов, вызывающих тревогу',
                              'Pd': ' Реализация эмоциональной напряженности в непосредственном поведении',
                              'Mf': ' Выраженность мужских и женских черт характера',
                              'Pa': ' Ригидность аффекта',
                              'Pt': ' Фиксация тревоги и ограничительное поведение',
                              'Sc': ' Аутизация',
                              'Ma': ' Отрицание тревоги, гипоманиакальные тенденции',
                              'Si': ' Социальная интроверсия'}.items():
        result = results[scale]
        score = result['matched_count']
        scale_norms_M = norms_M[scale]
        scale_norms_F = norms_F[scale]

        # Получаем максимальные значения в шкалах
        max_scale_score_M = max(scale_norms_M.keys()) if scale_norms_M else 0
        max_scale_score_F = max(scale_norms_F.keys()) if scale_norms_F else 0

        # Определяем нормы для мужчин и женщин
        norm_M = scale_norms_M.get(score,
                                   scale_norms_M.get(max_scale_score_M, 0))
        norm_F = scale_norms_F.get(score,
                                   scale_norms_F.get(max_scale_score_F, 0))

        # Добавляем интерпретацию в зависимости от шкалы и значения
        interpretation = get_scale_interpretation(scale, norm_M if gender == 'male' else norm_F, gender)

        # Добавляем данные в словарь
        data_norms[f'scale_{scale}'] = {
            'scale_name': scale_name,
            'summ': score,
            'Norm_M': norm_M,
            'Norm_F': norm_F,
            'interpretation': interpretation,
        }

    return data_norms


def get_scale_interpretation(scale_name, norm_value, gender=None):
    interpretations = {
        'L': {
            (0, 70): "Не выводим",
            (71, 80): "Результаты тестирования сомнительны вследствие стремления испытуемого представить себя в благоприятном свете.",
            (81, float('inf')): "Результаты тестирования недостоверны."
        },
        'F': {
            (0, 60): "Не выводим",
            (61, 70): "Внутренняя напряженность, недовольство ситуацией.",
            (71, 80): "Поиск помощи., Возможно небрежное выполнение теста.",
            (81, float(
                'inf')): "Результаты тестирования недостоверны., Возможно стремление к аггравации или установочное поведение, что затрудняет или блокирует интерпретацию., При тревоге, депрессии и других психопатологических состояниях нередко имеется «призыв к помощи», интерпретация результатов возможна. Однако необходимо учитывать показатели по другим шкалам., При выраженных галлюцинаторно-бредовых состояниях может отражать снижение критики к своему состоянию."
        },
        'K': {
            (0, 40): "Критическое отношение к себе и окружающим, скепсис. Общая неудовлетворенность и уязвимость., Склонность преувеличивать существующие конфликты. Тенденция порождать неловкость в межличностных отношениях., При значительном снижении баллов может отмечаться явно неконформное, отклоняющееся от традиций и обычаев, поведение. У окружающих это поведение может вызывать выраженную отрицательную реакцию.",
            (41, 69): "Сбалансированная конформность.",
            (70, 75): "Стремление произвести благоприятное впечатление, подчеркивание приверженности нормам",
            (76, float(
                'inf')): "Поведение в значительной степени определяется потребностью в социальном одобрении и озабоченностью своим социальным статусом., Имеет место отрицание затруднений в межличностных отношениях или в контроле за собственным поведением., Стремление к строгому соблюдению принятых норм и уклонение от критики окружающих в той мере, в которой поведение окружающих укладывается в рамки принятой нормы., Жизнь строится в соответствии с социальными «условиями ценности» (приобретение материальных благ и стремление к социальному признанию)."
        },
        'Hs': {
            (0, 50): "Отсутствует озабоченность своим соматическим состоянием",
            (51, 70): "Повышенное внимание к своему физическому состоянию, стремление (обычно непоследовательное) вести здоровый образ жизни.",
            (71,
             79): "Озабоченность своим соматическим состоянием, целенаправленная организация «здорового» образа жизни.",
            (80, float(
                'inf')): "Чрезмерная фиксация на неприятных телесных ощущениях и дисфункциях, что нарушает адаптацию., Появление необъяснимых с медицинской точки зрения неприятных телесных ощущений, которые, как правило, относятся к различным органам и системам организма."
        },
        'D': {
            (0, 59): "Не выводим",
            (60, 69): "Тревожно-депрессивная акцентуация. Пониженное, грустное настроение, с элементами пассивности и пессимизма., Склонность к умеренным тревожным реакциям в рамках, которые не нарушают адаптацию.",
            (70,
             79): "Отчетливые тревожно-депрессивные проявления с тенденцией к блокаде побуждений, обесцениванию, пассивности., Часто переживается умеренная тоска, апатия и анергия., При сочетании с повышением по шкале Mа может указывать на смешанный аффект или неполную или неустойчивую депрессию.",
            (80, float(
                'inf')): "Выраженные депрессивные проявления, сопровождающиеся отчетливой клинической симптоматикой в виде развернутого депрессивного или тревожно-депрессивного синдрома., При сочетании с повышением профиля по шкале Mа может указывать на смешанный аффект."
        },
        'Hy': {
            (0, 39): "Склонность к интроверсии, скептицизм, пониженная спонтанность в контактах, низкая интуиция.",
            (40, 70): "Не выводим",
            (71, 74): "Истерическая акцентуация со стремлением находиться в центре внимания, ощущением недостаточной востребованности.",
            (75,
             79): "Склонность к вытеснению некоторых неприятных или неприемлемых переживаний и фактов. Эгоцентризм, ощущение собственной недостаточной востребованности, стремление находиться в центре внимания., Недостаточная критичность к себе., Поиск поддержки со стороны окружения. При одновременном повышении профиля по шкале Hs нередко отмечаются попытки «давления» на окружающих при помощи соматической симптоматики.",
            (80, float(
                'inf')): "Высокий уровень вытеснения неприятных или неприемлемых переживаний и фактов. Самолюбование, стремление «играть себя»., Стремление к манипулированию окружающими или их психологическому «соблазнению»., Игнорирование отрицательных сигналов из окружения, бесцеремонность в поведении., Недостаточная критичность восприятия себя и своего поведения., Не исключены диссоциативные реакции."
        },
        'Pd': {
            (0, 39): "•	Гиперсоциальность, отождествление себя с социальными нормами и своим социальным статусом., Нетерпимость к ненормативному поведению, склонность к морализаторству.",
            (40, 64): "Не выводим",
            (65, 69): "Импульсивность, непоследовательность поведения., Протестность, нонконформизм., Возможны аффективные «разряды».",
            (70,
             79): "Импульсивность, несдержанность, повышенная конфликтность., Пренебрежительное отношение к окружающим, склонность к авантюрам, игнорирование ряда социальных норм., Сложности в прогнозировании и последовательной реализации планов, непоследовательность.",
            (80, float('inf')): "Импульсивность, агрессивность, авантюризм"
        },
        'Mf': {
            'male': {
                (0,
                 29): "Внутренняя детерминированность поступков, рационализм и прагматизм, склонность к обдумыванию и планированию своих действий. Потребность в лидерстве и доминировании, способность к прямой конфронтации вплоть до открытого проявления агрессивных тенденций. Низкий интерес к эмоциональным переживаниям, нечувствительность к нюансам эмоциональных переживаний, грубоватость. Толерантность к физическим нагрузкам и дискомфорту, невысокий интерес к искусству и фантазированию.",
                (30, 69): "Не выводим",
                (70,
                 79): "Повышенная ранимость и чувствительность. Неуверенность в себе., Совестливость и склонность к сомнениям., Фиксация на своих переживаниях., Низкая склонность к проявлению агрессивных тенденций., Сентиментальность. Богатое воображение., В случае изолированного подъема или в сочетании с подъемом по шкале K может отражать попытку скрыть имеющуюся симптоматику или эмоционально насыщенные проблемы.",
                (80, float(
                    'inf')): "Отчетливая феминность в поведении., Избегание агрессии., Высокая ранимость, уязвимость, неуверенность и незащищенность., Поиск защиты и опеки, эгоцентризм., Богатое воображение., В случае изолированного подъема или в сочетании с подъемом по шкале K может отражать попытку скрыть имеющуюся симптоматику или эмоционально насыщенные проблемы"
            },
            'female': {
                (0,
                 29): "Ощущение незащищенности, высокая чувствительность к нюансам отношений, повышенная эмоциональная рецептивность и склонность полагаться на интуицию. Невысокая рациональность, преобладание аффективной логики. Несамостоятельность, потребность в поддержке и защите, черты детскости. Подчиняемость, пассивность, отказ от лидерства.",
                (30, 69): "Не выводим",
                (70,
                 79): "Непринужденность поведения, уверенность в себе. Склонность к доминированию. Тенденция к обдумыванию своих действий и последовательной реализации намеченных целей. Способность оказывать эмоциональную и деятельную поддержку. В случае изолированного подъема или в сочетании с подъемом по шкале K может отражать попытку скрыть имеющуюся симптоматику или эмоционально насыщенные проблемы.",
                (80, float(
                    'inf')): "Несогласие с традиционной женской ролью. Демонстрация уверенности в себе, стремление к автономии, лидерству и доминированию, что сочетается со способностью на прямую конфронтацию. Невысокая чувствительность к нюансам межличностных отношений, предпочтение прямых и открытых форм взаимодействия с окружающими, некоторая прямолинейность, решительность. Возможно предпочтение мужских профессий. В случае изолированного подъема или в сочетании с подъемом по шкале K может отражать попытку скрыть имеющуюся симптоматику или эмоционально насыщенные проблемы."
            }
        },
        'Pa': {
            (0, 40): "Может отражать попытку скрыть паранойяльную настороженность",
            (41, 65): "Не выводим",
            (66, 70): "Тенденция к самоутверждению. Честолюбие. Аффективная ригидность, недоверчивость, усиленное стремление отстаивать свои права, ревнивость.",
            (71, 80): "Склонность к подозрительности, критическое, настороженное или враждебное отношение к окружающим., Выраженная склонность к образованию сверхценных идей и формированию жестких концепций поведения., Тенденция к самоутверждению. Честолюбие. Озабоченность своим престижем, повышенное себялюбие, недовольство отсутствием или недостаточностью признания со стороны окружающих.",
            (81, float(
                'inf')): "Выраженная склонность к формированию ложных суждений и умозаключений, занимающих доминирующее положение в сознании, не поддающихся разубеждению. Нередко указывает на наличие отчетливых сверхценных или бредовых нарушений."
        },
        'Pt': {
            (0, 50): "Решительность, гибкость поведения",
            (51, 70): "Не выводим",
            (71,
             80): "Выраженная тревожность, нередко постоянного или хронического характера, нарушающая адаптацию., Склонность к навязчивым страхам, сомнениям. Возможны отдельные панические приступы., Стремление контролировать ситуацию, легко возникающий страх по поводу возможных негативных последствий. Ограничительное и избегающее поведение., Сомнения и колебания при необходимости принять самостоятельное решение., Высокий уровень внутренних стандартов поведения., Осторожность, стремление контролировать проявление собственных эмоций и спонтанности.",
            (81, float(
                'inf')): "Постоянная повышенная тревожность., Выраженная склонность к навязчивым страхам, беспокойству. Напряженность., Избегание ситуаций с мало предсказуемым исходом, быстрой сменой действующих факторов, неупорядоченных и неопределенных ситуаций., Стремление максимально контролировать внешние обстоятельства и свои поступки, зачастую за счет блокады большинства видов активности., Стремление придерживаться жесткой системы внутренних стандартов и правил, максимально обеспечивающих безопасность., Возможны панические приступы или выраженные фобии."
        },
        'Sc': {
            (0, 60): "Не выводим",
            (61,
             70): "Своеобразие восприятия, мышления и оценки окружающего, что проявляется в суждениях, внешнем виде и поведении., Вероятны деперсонализационные переживания, которые не всегда ясно осознаются вследствие несбалансированной оценки реальности., Характерна ориентация на внутренние критерии, утрата способности к интуитивному пониманию окружающих, что может приводить к нарушению в установлении социальных контактов., Может наблюдаться некоторая эксцентричность поведения. Ранимость. Отсутствие четких представлений о том, как именно нужно вести себя в той или иной ситуации или того, что именно ждут от них окружающие.",
            (71,
             80): "Своеобразие восприятия, мышления и оценки окружающего, что проявляется в суждениях, внешнем виде и поведении., Вероятны деперсонализационные переживания, которые не всегда ясно осознаются вследствие несбалансированной оценки реальности., Характерна ориентация на внутренние критерии, утрата способности к интуитивному пониманию окружающих, что может приводить к нарушению в установлении социальных контактов., Может наблюдаться некоторая эксцентричность поведения. Ранимость. Отсутствие четких представлений о том, как именно нужно вести себя в той или иной ситуации или того, что именно ждут от них окружающие.",
            (81, float(
                'inf')): "Дистанцированность, отчужденность, погруженность во внутренний мир. Эмоциональная обедненность, равнодушие к окружающим сочетается с повышенной ранимостью и чувствительностью к отдельным аспектам реальности и самооценки., затруднения в объективированной оценке ситуации и общей картины мира, что часто проявляется в суждениях, внешнем виде и поведении., Вероятны деперсонализационно-дереализационные переживания., Выраженное своеобразие восприятия, мышления и оценки окружающего, трудности в коммуникациях с другими людьми., Не исключены обманы восприятия, нарушения интерпретации телесных ощущений и «квази-психотические» проявления., При контактах с другими ощущение внутренней напряженности и глубокого отличия от окружающих."
        },
        'Ma': {
            (0, 40): "Снижение активности, анергия",
            (41, 65): "Не выводим",
            (66, 70): "Высокая активность, оптимизм",
            (71, 80): "Повышенная активность, расторможенность",
            (81, float(
                'inf')): "Повышенная самооценка, переоценка своих возможностей и способностей., Чрезмерная и плохо организованная активность, нарушающая адаптацию. Действия часто не доводятся до конца из-за переключения внимания на другие объекты либо из-за неправильной оценки собственных возможностей и текущих обстоятельств., Характерно эмоциональное возбуждение, взрывчатость и раздражительность, иногда грубость., Нередко отмечается общая расторможенность, включающая импульсивную агрессивность или провоцирующую сексуальность., Страх и тревога подавляются и отрицаются, грубо нарушена прогностическая деятельность. Могут отмечаться «скачки» идей."
        },
        'Si': {
            (0, 40): "Стремление к контактам, общительность",
            (41, 69): "Не выводим",
            (70, 79): "Затруднения при осуществлении межличностных контактов., Замкнутость, необщительность, стремление к деятельности, не связанной с общением., При необходимости вступать в контакты возникает тревога, стремление их всячески ограничить или, по возможности, уклониться от них., Общение с другими людьми обычно носит поверхностный и незаинтересованный характер., При этом возможны отдельные избирательные контакты с другими людьми. Тем не менее, и эти контакты обычно ограничиваются довольно узкими сферами (работа, имущественные отношения, увлечения)., Выраженная интроверсия с ориентацией на внутренние стандарты.",
            (80, float(
                'inf')): "Аутизация, погруженность в свой внутренний мир., Активное избегание межличностных контактов, отсутствие или значительная неразвитость коммуникативных навыков., Сильная тревога при вынужденной необходимости вступать во взаимодействие с другими людьми."
        }
    }

    if scale_name == 'Mf' and gender in ['male', 'female']:
        gender_interpretations = interpretations[scale_name].get(gender, {})
        for score_range, text in gender_interpretations.items():
            if score_range[0] <= norm_value <= score_range[1]:
                return text
    else:
        for score_range, text in interpretations.get(scale_name, {}).items():
            if score_range[0] <= norm_value <= score_range[1]:
                return text

    return "Интерпретация не определена"


def calculate_matches(questions, answer_list):
    sign_dict = {}
    for sign, question_num in answer_list:
        sign_dict[question_num] = sign  # sign теперь 1 или 2

    matches = []
    non_matches = []
    missing = []

    for num in questions:
        # Определяем ожидаемый знак:
        # если num положительный - ожидаем 1, если отрицательный - ожидаем 2
        expected_sign = 1 if num > 0 else 2 if num < 0 else 0
        question_num = abs(num)

        if question_num in sign_dict:
            actual_sign = sign_dict[question_num]
            if expected_sign == actual_sign:
                matches.append(num)
            else:
                non_matches.append(num)
        else:
            missing.append(num)

    return {
        "matched_count": len(matches),
        "matched_items": matches,
        "non_matched_count": len(non_matches),
        "non_matched_items": non_matches,
        "missing_count": len(missing),
        "missing_items": missing
    }


results = calculate_all_matches(MMIL.answer_test_yes, 'male')
results2 = calculate_all_matches(MMIL.answer_test_yes, 'female')

print(results)
print(results2)



